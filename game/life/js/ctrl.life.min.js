jQuery(function(){var w=120,p=100,B=80,D=60;var v=null,t={},c;var k=0,j=0,g=3,a=true;var h=[4096,3943,3793,3647,3505,3367,3232,3101,2974,2850,2730,2613,2499,2389,2282,2178,2077,1980,1885,1794,1705,1620,1537,1457,1380,1306,1234,1165,1098,1034,973,914,857,803,751,701,654,608,565,523,484,447,411,378,346,316,287,260,235,212,190,169,150,132,115,100,86,73,61,50,40,31,23,16];function i(){var s=0;for(var d=w;d>0;--d){for(var x=p;x>0;--x){if(t.live[t.data[d%w*p+x%p]]){t.tempX[s]=d;t.tempY[s]=x;++s}}}while(--s>=0){t.blockChange(t.tempX[s],t.tempY[s])}}function f(d,s,x){return Math.max(d,Math.min(Math.floor(s),x))}function z(d){var s=location.search.substr(1).match(new RegExp("(^|&)"+d+"=([^&]*)(&|$)","i"));return(s!=null)?unescape(s[2]):null}function m(){return v?r():e()}function e(){if(!v){v=setInterval(i,h[D-1])}}function r(){if(v){clearInterval(v);v=null}}function b(){for(var s=t.width;s>0;--s){for(var d=t.height;d>0;--d){if(100*Math.random()>B^t.blockState(s,d)){t.blockChange(s,d)}}}}function u(){for(var s=t.width;s>0;--s){for(var d=t.height;d>0;--d){if(t.blockState(s,d)){t.blockChange(s,d)}}}}function A(){$("#container").height($(document.body).height()-$("#panel").height()-$("#wrapper h3").height()-40)}function C(x,F,G){this.width=F;this.height=G;this.blockSize=1+Math.ceil(64/Math.sqrt(Math.sqrt(F*G)));this.directSize=1+this.blockSize;this.eraseSize=1+this.directSize;this.tempX=new Array(F*G);this.tempY=new Array(F*G);this.data=new Array(F*G);this.live=new Array(1<<9);this.mouseX=0;this.mouseY=0;this.mouseState=0;this.canvas=document.createElement("canvas");try{this.ctx=this.canvas.getContext("2d")}catch(H){return null}this.blockState=function(I,J){return Boolean(this.data[I%F*G+J%G]&1)};this.blockChange=function(I,J){if(this.blockState(I--,J--)){this.ctx.clearRect(I*this.directSize,J*this.directSize,this.eraseSize,this.eraseSize)}else{this.ctx.fillRect(1+I*this.directSize,1+J*this.directSize,this.blockSize,this.blockSize)}this.data[I%F*G+J%G]^=256;this.data[++I%F*G+J%G]^=128;this.data[++I%F*G+J%G]^=64;this.data[I%F*G+ ++J%G]^=32;this.data[I%F*G+ ++J%G]^=16;this.data[--I%F*G+J%G]^=8;this.data[--I%F*G+J%G]^=4;this.data[I%F*G+ --J%G]^=2;this.data[++I%F*G+J%G]^=1};this.onblockchange=function(I,J){if(I>0&&J>0&&I<=F&&J<=F){if(this.blockState(I,J)&&(this.mouseState&2)||!this.blockState(I,J)&&(this.mouseState&1)){this.blockChange(I,J)}}};this.canvas.width=F*this.directSize+1;this.canvas.height=G*this.directSize+1;this.canvas.style.border="solid 4px #ccc";this.canvas.style.cursor="crosshair";this.ctx.fillStyle="#000";document.getElementById(x).innerHTML="";document.getElementById(x).appendChild(this.canvas);for(var d=0,y=0,s=0;d<1<<9;y=0){y+=d>>8&1;y+=d>>7&1;y+=d>>6&1;y+=d>>5&1;y+=d>>4&1;y+=d>>3&1;y+=d>>2&1;y+=d>>1&1;this.live[d]=y==3&&s==0||y!=2&&y!=3&&s==1;s=++d&1}for(var E=F*G-1;E>=0;--E){this.data[E]=0;this.tempX[E]=this.tempY[E]=0}}var n=Number(z("x")),l=Number(z("y")),q=Number(z("d")),o=Number(z("s"));!n||(w=f(2,n,1024)),$("#x").val(w);!l||(p=f(2,l,1024)),$("#y").val(p);!q||(B=f(0,q,100)),$("#d").val(B);!o||(D=f(1,o,64)),$("#s").val(D);C.call(t,"container",w,p);b();if(!t){document.getElementById("container").innerHTML="<strong>鎮ㄧ殑娴忚鍣ㄤ笉鏀寔姝ゆ父鎴忥紒</strong>"}$(document).keydown(function(d){if(a){switch(d.which){case 13:case 108:if(d.ctrlKey){e()}else{if(d.shiftKey){r()}else{m()}}break;case 32:r();i();break;case 82:r();b();break;case 67:r();u();break}}});$(t.canvas).mousedown(function(s){var d=t.canvas.getBoundingClientRect();k=f(1,(s.clientX-4-((8+t.canvas.width)/d.width)*d.left)/t.directSize+1,t.width);j=f(1,(s.clientY-4-((8+t.canvas.height)/d.height)*d.top)/t.directSize+1,t.height);t.mouseState=g;t.onblockchange(k,j)}).mouseup(function(d){t.mouseState=k=j=0}).mousemove(function(y){var s=t.canvas.getBoundingClientRect();var x=f(1,(y.clientX-4-((8+t.canvas.width)/s.width)*s.left)/t.directSize+1,t.width);var d=f(1,(y.clientY-4-((8+t.canvas.height)/s.height)*s.top)/t.directSize+1,t.height);if(x!=k||d!=j){t.onblockchange(k=x,j=d)}}).mouseout(function(d){t.mouseState=k=j=0});$("#default").click(function(d){$("#x").attr("disabled","disabled");$("#y").attr("disabled","disabled");$("#d").attr("disabled","disabled");$("#s").attr("disabled","disabled")});$("#clear").click(function(d){r();u();$(this).blur()});$("#step").click(function(d){r();i();$(this).blur()});$("#start").click(function(d){e();$(this).blur()});$("#stop").click(function(d){r();$(this).blur()});$("#random").click(function(d){r();b();$(this).blur()});$(window).resize(A);$("#panel").accordion({active:2,collapsible:true,heightStyle:"content"}).on("accordionactivate",A).accordion("option","active",0);$("#options *, #panel h3:last").focus(function(d){a=false}).blur(function(d){a=true});$("#wrapper").accordion({heightStyle:"fill"});$("input[type=submit], button").css("margin","0.2em 0").button();$("#x-slider").slider({min:2,max:1024,value:w,slide:function(d,s){$("#x").val(s.value)}});$("#y-slider").slider({min:2,max:1024,value:p,slide:function(d,s){$("#y").val(s.value)}});$("#d-slider").slider({min:0,max:100,value:B,slide:function(d,s){$("#d").val(s.value)}});$("#s-slider").slider({min:1,max:64,value:D,slide:function(d,s){$("#s").val(s.value)}});$("#x").spinner({min:2,max:1024,start:w}).bind("input propertychange spin",function(d,s){$("#x-slider").slider("value",s.value)});$("#y").spinner({min:2,max:1024,start:p}).bind("input propertychange spin",function(d,s){$("#y-slider").slider("value",s.value)});$("#d").spinner({min:0,max:100,start:B}).bind("input propertychange spin",function(d,s){$("#d-slider").slider("value",s.value)});$("#s").spinner({min:1,max:64,start:D}).bind("input propertychange spin",function(d,s){$("#s-slider").slider("value",s.value)})});